From 41ef201482df239541d8e5c461fbcf7e2ca97c90 Mon Sep 17 00:00:00 2001
From: Seal <info@sealsecurity.io>
Date: Thu, 21 Nov 2024 18:26:23 +0200
Subject: [PATCH] CVE-2017-6508

---
 src/url.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/src/url.c b/src/url.c
index d0b94a9..5cc37a3 100644
--- a/src/url.c
+++ b/src/url.c
@@ -879,6 +879,17 @@ url_parse (const char *url, int *error, struct iri *iri, bool percent_encode)
       url_unescape (u->host);
       host_modified = true;
 
+      /* check for invalid control characters in host name */
+      for (p = u->host; *p; p++)
+        {
+          if (c_iscntrl(*p))
+            {
+              url_free(u);
+              error_code = PE_INVALID_HOST_NAME;
+              goto error;
+            }
+        }
+
       /* Apply IDNA regardless of iri->utf8_encode status */
       if (opt.enable_iri && iri)
         {
-- 
2.39.5

